name: PdoStoreTest
class_comment: "# * @author J\xE9r\xE9my Deruss\xE9 <jeremy@derusse.com>\n# *\n# *\
  \ @requires extension pdo_sqlite"
dependencies:
- name: InvalidTtlException
  type: class
  source: Symfony\Component\Lock\Exception\InvalidTtlException
- name: Key
  type: class
  source: Symfony\Component\Lock\Key
- name: PersistingStoreInterface
  type: class
  source: Symfony\Component\Lock\PersistingStoreInterface
- name: PdoStore
  type: class
  source: Symfony\Component\Lock\Store\PdoStore
- name: ExpiringStoreTestTrait
  type: class
  source: ExpiringStoreTestTrait
properties: []
methods:
- name: testDsnWithSQLite
  visibility: public
  parameters:
  - name: dsn
  - name: file
    default: 'null'
  comment: "# * @author J\xE9r\xE9my Deruss\xE9 <jeremy@derusse.com>\n# *\n# * @requires\
    \ extension pdo_sqlite\n# */\n# class PdoStoreTest extends AbstractStoreTestCase\n\
    # {\n# use ExpiringStoreTestTrait;\n# \n# protected static string $dbFile;\n#\
    \ \n# public static function setUpBeforeClass(): void\n# {\n# self::$dbFile =\
    \ tempnam(sys_get_temp_dir(), 'sf_sqlite_lock');\n# \n# $store = new PdoStore('sqlite:'.self::$dbFile);\n\
    # $store->createTable();\n# }\n# \n# public static function tearDownAfterClass():\
    \ void\n# {\n# @unlink(self::$dbFile);\n# }\n# \n# protected function getClockDelay():\
    \ int\n# {\n# return 1000000;\n# }\n# \n# public function getStore(): PersistingStoreInterface\n\
    # {\n# return new PdoStore('sqlite:'.self::$dbFile);\n# }\n# \n# public function\
    \ testAbortAfterExpiration()\n# {\n# $this->markTestSkipped('Pdo expects a TTL\
    \ greater than 1 sec. Simulating a slow network is too hard');\n# }\n# \n# public\
    \ function testInvalidTtl()\n# {\n# $this->expectException(InvalidTtlException::class);\n\
    # $store = $this->getStore();\n# $store->putOffExpiration(new Key('toto'), 0.1);\n\
    # }\n# \n# public function testInvalidTtlConstruct()\n# {\n# $this->expectException(InvalidTtlException::class);\n\
    # \n# return new PdoStore('sqlite:'.self::$dbFile, [], 0.1, 0);\n# }\n# \n# /**\n\
    # * @dataProvider provideDsnWithSQLite"
- name: provideDsnWithSQLite
  visibility: public
  parameters: []
  comment: null
- name: testDsnWithPostgreSQL
  visibility: public
  parameters: []
  comment: '# * @requires extension pdo_pgsql

    # *

    # * @group integration'
traits:
- Symfony\Component\Lock\Exception\InvalidTtlException
- Symfony\Component\Lock\Key
- Symfony\Component\Lock\PersistingStoreInterface
- Symfony\Component\Lock\Store\PdoStore
- ExpiringStoreTestTrait
interfaces: []
